/*!
 * Start Bootstrap - Dress By Heart v0.0.1 (https://dressbyheart.se)
 * Copyright 2013-2017 Dress By Heart
 * Licensed under  ()
 */
$(document).ready(function(){function e(e){$.get("/api/event/places_left/"+e,function(e){console.log("places left",e.places_left),n.places_left=e.places_left,$(".places-left").html(e.places_left)})}console.log("anmälan page loaded");var a=location.hash.replace("#","").replace("/","");console.log("event_route",a);var n={};$.get("/api/event/"+a,function(a){console.log("event",a),n.event=a,e(n.event.id)}),$("#anmalanForm input,#anmalanForm textarea").jqBootstrapValidation({preventSubmit:!0,submitError:function(e,a,n){},submitSuccess:function(a,t){t.preventDefault();var s=$("#anmalanForm input#firstname").val(),l=$("#anmalanForm input#lastname").val(),r=$("#anmalanForm input#email").val(),o=$("#anmalanForm input#places").val();return console.log("places left",n.places_left,o,event),parseInt(o)>n.places_left?($("#anmalanForm #success").html("<div class='alert alert-danger'>"),$("#anmalanForm #success > .alert-danger").append($("<strong>").text("Du kan inte registrera fler platser än det finns ledigt!")),void $("#anmalanForm #success > .alert-danger").append("</div>")):void $.ajax({url:"../api/event/register",type:"POST",data:{event_id:n.event.id,name:s+" "+l,email:r,nbr_places:o},cache:!1,success:function(){$("#anmalanForm #success").html("<div class='alert alert-success'>"),$("#anmalanForm #success > .alert-success").append("<strong>Tack för ditt intresse! Infomation om anmälan kommer skickas till din e-postadress.</strong>"),$("#anmalanForm #success > .alert-success").append("</div>"),$("#anmalanForm").trigger("reset"),$("#anmalanForm button[type=submit]").hide(),$("#anmalanForm button#close").show(),e(n.event.id)},error:function(e){console.log(e),$("#anmalanForm #success").html("<div class='alert alert-danger'>"),$("#anmalanForm #success > .alert-danger").append($("<strong>").text("Sorry "+s+", it seems that my mail server is not responding. Please try again later!")),$("#anmalanForm #success > .alert-danger").append("</div>")}})},filter:function(){return $(this).is(":visible")}})});